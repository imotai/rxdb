"use strict";(globalThis.webpackChunkrxdb=globalThis.webpackChunkrxdb||[]).push([[6756],{9900(e,n,i){i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>t,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"replication-google-drive","title":"Google Drive Sync","description":"Sync your RxDB application state with Google Drive.","source":"@site/docs/replication-google-drive.md","sourceDirName":".","slug":"/replication-google-drive.html","permalink":"/replication-google-drive.html","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Google Drive Sync","slug":"replication-google-drive.html","description":"Sync your RxDB application state with Google Drive.","image":"/headers/replication-google-drive.jpg"},"sidebar":"tutorialSidebar","previous":{"title":"Supabase Replication","permalink":"/replication-supabase.html"},"next":{"title":"NATS Replication","permalink":"/replication-nats.html"}}');var r=i(4848),o=i(8453),l=i(3247);const t={title:"Google Drive Sync",slug:"replication-google-drive.html",description:"Sync your RxDB application state with Google Drive.",image:"/headers/replication-google-drive.jpg"},a="Replication with Google Drive (beta)",c={},d=[{value:"Overview",id:"overview",level:2},{value:"Usage",id:"usage",level:2},{value:"Enable Google Drive API",id:"enable-google-drive-api",level:3},{value:"Authenticate the User",id:"authenticate-the-user",level:3},{value:"Start Replication",id:"start-replication",level:3},{value:"Signaling &amp; WebRTC",id:"signaling--webrtc",level:2},{value:"Polyfill for Node.js",id:"polyfill-for-nodejs",level:3},{value:"Options",id:"options",level:2},{value:"googleDrive",id:"googledrive",level:3},{value:"pull &amp; push",id:"pull--push",level:3},{value:"Technical Details",id:"technical-details",level:2},{value:"File Mapping",id:"file-mapping",level:3},{value:"Checkpointing",id:"checkpointing",level:3},{value:"Conflict Resolution",id:"conflict-resolution",level:3},{value:"Limitations",id:"limitations",level:2},{value:"Testing",id:"testing",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",figure:"figure",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",span:"span",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"replication-with-google-drive-beta",children:"Replication with Google Drive (beta)"})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"replication-google-drive"})," plugin allows you to replicate your client-side ",(0,r.jsx)(n.a,{href:"./",children:"RxDB"})," database to a folder in the user's Google Drive. This enables cross-device ",(0,r.jsx)(n.a,{href:"/replication.html",children:"sync"})," for single users without requiring any backend server."]}),"\n",(0,r.jsx)("br",{}),"\n",(0,r.jsx)("p",{align:"center",children:(0,r.jsx)("img",{src:"./files/icons/google-drive.svg",alt:"Google Drive Sync",height:"60"})}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"The replication uses the Google Drive API v3 and v2."}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsxs)(n.strong,{children:[(0,r.jsx)(n.a,{href:"/offline-first.html",children:"Offline-First"}),":"]})," Users can work offline. Changes are synced when they go online."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"No Backend Required:"})," You don't need to host your own database server."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cross-Device:"})," Users can access their data from multiple devices by signing into the same Google account."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Realtime Sync:"})," Uses ",(0,r.jsx)(n.a,{href:"/replication-webrtc.html",children:"WebRTC"})," for peer-to-peer signaling to achieve near real-time updates. Uses the same google-drive folder instead of a signaling-server."]}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsxs)(n.p,{children:["This plugin is in ",(0,r.jsx)(n.strong,{children:"beta"})," since RxDB version 17.0.0."]})}),"\n",(0,r.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,r.jsxs)(l.g,{children:[(0,r.jsx)(n.h3,{id:"enable-google-drive-api",children:"Enable Google Drive API"}),(0,r.jsxs)(n.p,{children:["You need to enable the Google Drive API in the ",(0,r.jsx)(n.a,{href:"https://console.cloud.google.com/",children:"Google Cloud Console"})," and create credentials (OAuth 2.0 Client ID) for your application."]}),(0,r.jsx)(n.h3,{id:"authenticate-the-user",children:"Authenticate the User"}),(0,r.jsxs)(n.p,{children:["Your application must handle the OAuth flow to get an ",(0,r.jsx)(n.code,{children:"accessToken"})," from Google. You can use libraries like ",(0,r.jsx)(n.a,{href:"https://www.npmjs.com/package/@react-oauth/google",children:(0,r.jsx)(n.code,{children:"@react-oauth/google"})})," or the Google Identity Services SDK."]}),(0,r.jsx)(n.h3,{id:"start-replication",children:"Start Replication"}),(0,r.jsxs)(n.p,{children:["Once you have the ",(0,r.jsx)(n.code,{children:"accessToken"}),", you can start the replication."]}),(0,r.jsx)(n.figure,{"data-rehype-pretty-code-figure":"",children:(0,r.jsx)(n.pre,{style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0","data-language":"ts","data-theme":"css-variables",children:(0,r.jsxs)(n.code,{"data-language":"ts","data-theme":"css-variables",style:{display:"grid"},children:[(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" { replicateGoogleDrive } "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'rxdb/plugins/replication-google-drive'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:";"})]}),"\n",(0,r.jsx)(n.span,{"data-line":"",children:" "}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" replicationState"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" await"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" replicateGoogleDrive"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"({"})]}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    replicationIdentifier"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'my-app-drive-sync'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    collection"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" myRxCollection"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:" // [RxCollection](./rx-collection.md)"})]}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    googleDrive"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        oauthClientId"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'YOUR_GOOGLE_CLIENT_ID'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        authToken"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'USER_ACCESS_TOKEN'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        folderPath"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'my-app-data/user-1'"})]}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    }"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    live"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" true"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    pull"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        batchSize"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" 60"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"        modifier"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" doc "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" doc "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// (optional) modify invalid data"})]}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    }"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    push"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        batchSize"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" 60"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","})]}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"        modifier"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" doc "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" doc "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// (optional) modify before sending"})]}),"\n",(0,r.jsx)(n.span,{"data-line":"",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    }"})}),"\n",(0,r.jsx)(n.span,{"data-line":"",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"});"})}),"\n",(0,r.jsx)(n.span,{"data-line":"",children:" "}),"\n",(0,r.jsx)(n.span,{"data-line":"",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// Observe replication states"})}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"replicationState"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"."}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"error$"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".subscribe"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(err "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"    console"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".error"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'Replication error:'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-punctuation)"},children:","}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" err);"})]}),"\n",(0,r.jsx)(n.span,{"data-line":"",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"});"})}),"\n",(0,r.jsx)(n.span,{"data-line":"",children:" "}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"replicationState"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".awaitInitialReplication"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"()"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".then"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"(() "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"=>"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:"    console"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:".log"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"("}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'Initial replication done'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:");"})]}),"\n",(0,r.jsx)(n.span,{"data-line":"",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"});"})})]})})})]}),"\n",(0,r.jsx)(n.h2,{id:"signaling--webrtc",children:"Signaling & WebRTC"}),"\n",(0,r.jsxs)(n.p,{children:["Google Drive does not provide real-time events for file changes. If a user changes data on ",(0,r.jsx)(n.strong,{children:"User Device A"}),", ",(0,r.jsx)(n.strong,{children:"User Device B"})," would not know about it until it periodically polls the Drive API.\nTo achieve real-time updates, this plugin uses ",(0,r.jsx)(n.strong,{children:"WebRTC"})," to signal changes between connected devices."]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:['Devices create "signal files" in a ',(0,r.jsx)(n.code,{children:"signaling"})," subfolder on Google Drive."]}),"\n",(0,r.jsx)(n.li,{children:"Other devices detect these files, read the WebRTC connection data, and establish a direct P2P connection with each other."}),"\n",(0,r.jsx)(n.li,{children:'When a device makes a write, it sends a "RESYNC" signal via WebRTC to all connected peers to notify them about the change.'}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"polyfill-for-nodejs",children:"Polyfill for Node.js"}),"\n",(0,r.jsx)(n.p,{children:"WebRTC is native in browsers but requires a polyfill in Node.js."}),"\n",(0,r.jsx)(n.figure,{"data-rehype-pretty-code-figure":"",children:(0,r.jsx)(n.pre,{style:{backgroundColor:"var(--shiki-background)",color:"var(--shiki-foreground)"},tabIndex:"0","data-language":"ts","data-theme":"css-variables",children:(0,r.jsxs)(n.code,{"data-language":"ts","data-theme":"css-variables",style:{display:"grid"},children:[(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"import"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" wrtc "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"from"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:" 'node-datachannel/polyfill'"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"; "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// or 'wrtc' package"})]}),"\n",(0,r.jsx)(n.span,{"data-line":"",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// ..."})}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"const"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-constant)"},children:" replicationState"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" ="}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:" await"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:" replicateGoogleDrive"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"({"})]}),"\n",(0,r.jsx)(n.span,{"data-line":"",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"    // ..."})}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    signalingOptions"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:" {"})]}),"\n",(0,r.jsxs)(n.span,{"data-line":"",children:[(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"        wrtc "}),(0,r.jsx)(n.span,{style:{color:"var(--shiki-token-comment)"},children:"// Pass the polyfill here"})]}),"\n",(0,r.jsx)(n.span,{"data-line":"",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"    }"})}),"\n",(0,r.jsx)(n.span,{"data-line":"",children:(0,r.jsx)(n.span,{style:{color:"var(--shiki-foreground)"},children:"});"})})]})})}),"\n",(0,r.jsx)(n.h2,{id:"options",children:"Options"}),"\n",(0,r.jsx)(n.h3,{id:"googledrive",children:"googleDrive"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"oauthClientId"})," ",(0,r.jsx)(n.code,{children:"string"}),": The OAuth 2.0 Client ID of your application."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"authToken"})," ",(0,r.jsx)(n.code,{children:"string"}),": The valid access token associated with the user."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"folderPath"})," ",(0,r.jsx)(n.code,{children:"string"}),": The path to the folder in Google Drive where data should be stored.","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"The plugin will ensure this folder exists."}),"\n",(0,r.jsxs)(n.li,{children:["It must ",(0,r.jsx)(n.strong,{children:"not"})," be the root folder."]}),"\n",(0,r.jsxs)(n.li,{children:["It creates subfolders ",(0,r.jsx)(n.code,{children:"docs"})," (for data) and ",(0,r.jsx)(n.code,{children:"signaling"})," (for WebRTC)."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"apiEndpoint"})," ",(0,r.jsx)(n.code,{children:"string"})," (optional): Defaults to ",(0,r.jsx)(n.code,{children:"https://www.googleapis.com"}),". Useful for mocking or proxies."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"transactionTimeout"})," ",(0,r.jsx)(n.code,{children:"number"})," (optional): Default ",(0,r.jsx)(n.code,{children:"10000"})," (10s). The plugin uses a ",(0,r.jsx)(n.code,{children:"transaction"})," file in Drive to ensure data integrity during writes. This is the timeout after which a lock is considered stale."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"pull--push",children:"pull & push"}),"\n",(0,r.jsxs)(n.p,{children:["Standard RxDB ",(0,r.jsx)(n.a,{href:"/replication.html",children:"Replication Options"})," for batch size, modifiers, etc."]}),"\n",(0,r.jsx)(n.h2,{id:"technical-details",children:"Technical Details"}),"\n",(0,r.jsx)(n.h3,{id:"file-mapping",children:"File Mapping"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Each RxDB document corresponds to ",(0,r.jsx)(n.strong,{children:"one JSON file"})," in the ",(0,r.jsx)(n.code,{children:"docs"})," subfolder."]}),"\n",(0,r.jsxs)(n.li,{children:["The filename is ",(0,r.jsx)(n.code,{children:"[primaryKey].json"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"This simple mapping makes it easy to inspect or backup data manually."}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"checkpointing",children:"Checkpointing"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["The replication relies on the ",(0,r.jsx)(n.code,{children:"modifiedTime"})," of files in Google Drive."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"conflict-resolution",children:"Conflict Resolution"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Conflicts are handled using the standard RxDB ",(0,r.jsx)(n.a,{href:"/replication.html#conflict-handling",children:"conflict handling"})," strategies."]}),"\n",(0,r.jsx)(n.li,{children:"The plugin assumes a master-slave replication pattern where the client (RxDB) merges changes."}),"\n",(0,r.jsxs)(n.li,{children:["If the ",(0,r.jsx)(n.code,{children:"transaction"})," file is locked by another device, the write retries until the lock is released or times out."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"limitations",children:"Limitations"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Rate Limits:"})," Google Drive API has strict rate limits. The plugin attempts to handle 429 errors with exponential backoff, but heavy concurrent writes might hit these limits."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Latency:"})," Changes take time to propagate and appear in listings (eventual consistency), which the plugin handles internally."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Signaling Delay:"})," The initial WebRTC handshake requires writing and reading files from Drive, which can take a few seconds. Once connected, signaling is instant."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,r.jsxs)(n.p,{children:["For testing, it is recommended to use ",(0,r.jsx)(n.a,{href:"https://github.com/pubkey/google-drive-mock",children:"google-drive-mock"}),". It simulates the Google Drive API so you can run tests without real credentials."]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},3247(e,n,i){i.d(n,{g:()=>r});var s=i(4848);function r(e){const n=[];let i=null;return e.children.forEach(e=>{e.props.id?(i&&n.push(i),i={headline:e,paragraphs:[]}):i&&i.paragraphs.push(e)}),i&&n.push(i),(0,s.jsx)("div",{style:o.stepsContainer,children:n.map((e,n)=>(0,s.jsxs)("div",{style:o.stepWrapper,children:[(0,s.jsxs)("div",{style:o.stepIndicator,children:[(0,s.jsx)("div",{style:o.stepNumber,children:n+1}),(0,s.jsx)("div",{style:o.verticalLine})]}),(0,s.jsxs)("div",{style:o.stepContent,children:[(0,s.jsx)("div",{children:e.headline}),e.paragraphs.map((e,n)=>(0,s.jsx)("div",{style:o.item,children:e},n))]})]},n))})}const o={stepsContainer:{display:"flex",flexDirection:"column"},stepWrapper:{display:"flex",alignItems:"stretch",marginBottom:"1.5rem",position:"relative",minWidth:0},stepIndicator:{position:"relative",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start",width:"33px",marginRight:"1rem",minWidth:0},stepNumber:{width:"33px",height:"33px",borderRadius:"50%",backgroundColor:"var(--color-top)",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",marginTop:-4},verticalLine:{position:"absolute",top:29,bottom:"0",left:"50%",width:"1px",background:"linear-gradient(to bottom, var(--color-top) 0%, var(--color-top) 80%, rgba(0,0,0,0) 100%)",transform:"translateX(-50%)"},stepContent:{flex:1,minWidth:0,overflowWrap:"break-word"},item:{marginTop:"0.5rem"}}},8453(e,n,i){i.d(n,{R:()=>l,x:()=>t});var s=i(6540);const r={},o=s.createContext(r);function l(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);